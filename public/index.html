<!DOCTYPE html>
<html ng-app="musicLibrary">
<!--myList elements-->

<head>
  <title>Music Library</title>
  <link rel="stylesheet" type="text/css" href="style/header.css">
  <!--myList elements-->
  <link rel="stylesheet" type="text/css" href="style/myList.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script type="text/javascript" src="angular.min.js"></script>
<!--<script type="text/javascript" src="angular-route.js"> //is used to link between pages</script>-->
  <script type="text/javascript">
    var app = angular.module('musicLibrary', []); //ngRoute is a dependency

//Between where you initialize controller and before you initialize the app, you have to to the following:

    //in order to call it from the frontend I have to do what's called inject. Scope is another angular service, containing some functionality. We are using scope to diplay data on the front
    //http makes get request to server, which will give me the array of the items on the list
    app.controller('musicLibraryCtrl', function($scope, $http) {

//function to post the data
//I'm doing http.post to the route I am going to which is myList. The socond argument to post is the object newItem: $scope.newMeow
      $scope.submitNewItem = function() { //when clicking submit it is gonna call this function
        $http.post('/myList', {newItem: $scope.newItem}).then(function() { //its gonna send a post request to the server with the new item
          getItems(); //this will refresh the list when adding a new item
          $scope.newItem = ''; //this will make the text field be empty after I post an item
        });
      };
//we are calling scope.delete because we are calling it from the frontend
      $scope.removeItem = function(deletethisitem) {
        $http.put('/myList/remove', {item: deletethisitem}).then(function() { //its gonna send a post request to the server with the new item
          getItems(); //this will refresh the list when adding a new item
        });
      };
//to make the list item show up without having to refresh
      function getItems() {
        //response is a callback function, that is called when you succesfully get the list from the server. //this is done because you don't want the rest rest of the code to run before this is done. //http is a service. //.get is a function in that service. It calls the route 'list' and gets stuff. //it has another thing called a promise (then), which is like a string of functions. its a way to specify a callback. //what I just made here is called an API
        $http.get('/myList').then(function(response) {

          //setting the list with what we get back from the server
          $scope.myList = response.data;
        });
      }
//call getItems when the page starts up, and it will load all of them
      getItems();


    });
  </script>
  <!--myList elements-->

</head>

<body ng-controller="musicLibraryCtrl"
  <!--header elements-->
<div>
  <h1>My Music Library </h1>
  <div id="menucolor">
    <nav id="navigation">
      <div>
        <ul id="navilist">
          <li id="menuitem">
            <a href="/index.html">My List</a>
          </li>
          <li id="menuitem">
            <a href="/findSongs.html">Find Songs</a>
          </li>
          <li id="menuitem">
            <a href="/signup.html">Sing Up</a>
          </li>
          <li id="menuitem">
            <a href="/login.html">Login</a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</div>
  <!--header elements-->

  <!--myList elements-->
  <div>
    <h2> MY LIST </h2>

    <div class="new-item">
      <input type="text" size="40" ng-model="newItem" placeholder="Add a song">
      <button type="button" size="40" ng-click="submitNewItem()">Add</button>
    </div>
    <p ng-repeat="items in myList">
      {{ items }}
      <!--ng-click becuase I am using agular-->
      <a href ng-click="remove(item)"><button class="btn"><i class="fa fa-trash"></i></button> <!--item?? is this the right one (should it be called items?)-->

    </p>
  </div>
  <!--myList elements-->


</html>
