<!DOCTYPE html>
<html>

<head>
  <title>login</title>
  <link rel="stylesheet" type="text/css" href="style/login.css">
  <link rel="stylesheet" type="text/css" href="style/header.css">
  <script type="text/javascript" src="angular.min.js"></script>

</head>



<body>
    <div id="menylist">
        <li><a href="/home.html">Home</a></li>
        <li><a href="/index.html">My List</a></li>
        <li><a href="/findSongs.html">Find Songs</a></li>
        <li><a href="/signup.html">Sign Up</a></li>
        <li><a href="/login.html">Login</a></li>
    </div>

<div class="loginForm">
    <h2>LOGIN</h2>
<form id="login-form">
    <input class="box" type="text" id="username-input" placeholder="Username">
    <br><br>
    <input class="box" type="password" id="password-input" placeholder="Password">
    <br><br>
    <input class="login" type="submit" id="login button" value="send">
  <!--  <button  type="button" ng-click="submitSignup()">LOGIN</button>-->
</form>
</div>

  </body>
</body>

<div>
    <IMG class="loginpic" SRC="pictures/login.jpg" ALT="noder" WIDTH=300 HEIGHT=300>
</div>

<div class="footer">
  <p>This website is made by Tanja Kartz Johansen: Contact information: tj@civagaard.dk</p>
</div>



  <script>
  //Javascript login (does not work)
       let loginForm = document.querySelector('#login-form')
       let usernameField = document.querySelector('#username-input')
       let passwordField = document.querySelector('#password-input')

       loginForm.addEventListener('submit', log => {
           log.preventDefault()

           loginUser()
       })

       function loginUser() {
           //Set the options for the fetch() method
           //parameters documentation: https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#
           let options = {
               method: 'post',
               credentials: 'include',
               headers: {
                   'content-type': 'application/json'
               },
               body: JSON.stringify({
                   username: usernameField.value,
                   password: passwordField.value
               })
           }

           //fetching end point and getting response
           //second parameter of fetch method (options): Allows control different settings.
           //fetch method with 2 parameters: path to resource we want to fetch and init object options
           fetch('/api/auth', options)
               //return the promise that fetch returns
               .then(response => response.json())
               //return promise that validate status
               .then(response => {
                   if (response.status == 'OK') {
                     //and redirect user to new page
                       document.location.href = './home.html'
                   } else {
                       alert(response.message)
                   }
               })
       }
   </script>



</html>
